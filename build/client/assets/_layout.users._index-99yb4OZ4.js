import{d as j,w as N}from"./vendor-router-C5YTkdq4.js";import{r as i,j as a}from"./vendor-react-D3RE0R8o.js";import{c as m}from"./companyUser.service-BerwkOpn.js";import{u}from"./users.service-CI0k8rR4.js";import{u as d}from"./modal.service-DONi3Oau.js";import{u as U}from"./notification.service-CvsIel6B.js";import{D as I}from"./DynamicTable-BPyWbqtX.js";import"./api-BB9j10S9.js";function A(){const o=j(),b=d(e=>e.confirmDelete),f=d(e=>e.confirmEnable),r=U(e=>e.showToast),[p,y]=i.useState([]),[h,g]=i.useState(0),[c,w]=i.useState("SortField=id&SortOrder=asc&PageNumber=1&PageSize=100"),n=[{key:"email",sortKey:"User.Email",label:"Email",filterable:!0,sortable:!0,filterType:"text"},{key:"role",label:"Role",filterable:!0,sortable:!1,filterType:"select",selectMode:"multiple",filterOptions:[]},{key:"active",label:"Status",filterable:!0,filterType:"select",selectMode:"single",sortable:!0,filterOptions:[{id:"true",label:"Ativo"},{id:"false",label:"Inativo"}]},{key:"actions",label:"Actions",type:"action"}],x=[{label:"Editar",action:"edit",icon:"edit"},{label:"Desativar",action:"disable",icon:"block",showCondition:e=>e.activeValue},{label:"Ativar",action:"enable",icon:"check_circle",showCondition:e=>!e.activeValue}],E=async()=>{try{const e=await m.getRoles(),t=n.find(s=>s.key==="rolesId");t&&(t.filterOptions=e.map(s=>({id:s.id,label:s.name})))}catch(e){console.error("Erro ao carregar roles:",e)}},l=async()=>{try{const e=await m.getAllUsers(c);console.log(e),g(e.totalItems),y(e.items.map(t=>({id:t.userId,email:t.userEmail,role:t.userRoles.map(s=>s).join(", ")||"",rolesId:t.userRoles?.map(s=>s).join(", ")||"",active:t.userActive?"Ativo":"Inativo",activeValue:t.userActive})))}catch(e){console.error("Erro ao carregar usuÃ¡rios:",e)}},S=async e=>{switch(e.action){case"edit":o(`/users/${e.item.id}`);break;case"disable":if(await b({description:"This action will permanently disable",itemName:e.item.email,buttonName:"Yes, Disabled"}))try{await u.disabledUser({id:Number(e.item.id),callerEmail:e.item.email}),r("Success","User successfully disabled","success"),l()}catch{r("Error","Failed to disable user","error")}break;case"enable":if(await f({itemName:e.item.email}))try{await u.enabledUser({id:Number(e.item.id),callerEmail:e.item.email}),r("Success","User successfully active","success"),l()}catch{r("Error","Failed to enable user","error")}break}},v=async()=>{await E(),await l()};return i.useEffect(()=>{v().then()},[c]),a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-8",children:[a.jsx("h1",{className:"text-3xl sm:text-4xl font-semibold text-text-primary",children:"Users"}),a.jsx("button",{onClick:()=>o("/users/create"),className:"inline-flex items-center justify-center px-5 py-2.5 rounded-xl font-medium text-white bg-orange hover:bg-orange/90 shadow-sm hover:shadow transition-all duration-200",children:"Create User"})]}),a.jsx("section",{className:"mt-6",children:a.jsx(I,{columns:n,data:p,totalItems:h,pageSize:5,pageSizeOptions:[5,10,25,100],showFirstLastButtons:!0,actionMenuItems:x,onActionClick:S,onQueryParamsChange:w})})]})}const P=N(function(){return a.jsx(A,{})});export{P as default};
