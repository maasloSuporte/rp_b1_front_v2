import{v as p,r as g,j as e}from"./vendor-react-D3RE0R8o.js";import{c as N,d as b}from"./vendor-router-C5YTkdq4.js";import{d}from"./devices.service-BEkRjjz1.js";import{u as f}from"./notification.service-CvsIel6B.js";import"./api-BB9j10S9.js";function q(){const{id:n}=N(),i=b(),a=!!n,o=f(r=>r.showToast),{register:m,handleSubmit:l,formState:{errors:t},setValue:c}=p({defaultValues:{machineName:"",environment:"",hostName:"",ip:""}});g.useEffect(()=>{a&&n&&u(Number(n))},[n,a]);const u=async r=>{try{const s=await d.getByIdDevices(r);c("machineName",s.machineName),c("environment",s.environment||""),c("hostName",s.hostName||""),c("ip",s.ip||"")}catch(s){console.error("Erro ao carregar máquina:",s)}},h=async r=>{try{if(a&&n){const s={machineName:r.machineName,environment:r.environment,hostName:r.hostName,ip:r.ip};await d.updateDevice(Number(n),s),o("Sucess","Machine edited successfully","success"),i("/machines")}else{const s={machineName:r.machineName};await d.createDevice(s),o("Success","Machine created successfully","success"),i("/machines")}}catch(s){const x=s.response?.data?.message||"Falha ao salvar máquina";o("Error",x,"error")}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("button",{onClick:()=>i("/machines"),className:"text-primary hover:text-primary/80 mb-4",children:"← Voltar"}),e.jsx("h1",{className:"text-4xl font-semibold text-text-primary",children:a?"Edit Machine":"Create Machine"})]}),e.jsxs("form",{onSubmit:l(h),className:"bg-white rounded-lg shadow-card p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Machine Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...m("machineName",{required:"Machine name is required",minLength:{value:5,message:"Machine name must be at least 5 characters"}}),placeholder:"Machine name",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"}),t.machineName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.machineName.message})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Environment ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...m("environment",{required:a?"Environment is required":!1,minLength:{value:5,message:"Environment must be at least 5 characters"}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"}),t.environment&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.environment.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Host Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...m("hostName",{required:a?"Host name is required":!1,minLength:{value:3,message:"Host name must be at least 3 characters"}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"}),t.hostName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.hostName.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["IP ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...m("ip",{required:a?"IP is required":!1,pattern:{value:/^(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)){3}$/,message:"Invalid IP address format"}}),placeholder:"192.168.1.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"}),t.ip&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.ip.message})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>i("/machines"),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90",children:a?"Update":"Create"})]})]})]})}export{q as default};
