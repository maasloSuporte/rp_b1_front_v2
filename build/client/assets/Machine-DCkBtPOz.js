import{u as g,x as N,r as b,j as e}from"./vendor-react-GjWeapsa.js";import{c as f,d as y}from"./vendor-router-cHSbYr8A.js";import{d as l}from"./devices.service-uF7n0LQ8.js";import{u as v}from"./notification.service-DGIhKrzX.js";import"./api-Cdl3BoFR.js";function S(){const{t:s}=g("translation"),{id:i}=f(),m=y(),n=!!i,d=v(t=>t.showToast),{register:c,handleSubmit:h,formState:{errors:r},setValue:o}=N({defaultValues:{machineName:"",environment:"",hostName:"",ip:""}});b.useEffect(()=>{n&&i&&u(Number(i))},[i,n]);const u=async t=>{try{const a=await l.getByIdDevices(t);o("machineName",a.machineName),o("environment",a.environment||""),o("hostName",a.hostName||""),o("ip",a.ip||"")}catch(a){console.error("Erro ao carregar máquina:",a)}},p=async t=>{try{if(n&&i){const a={machineName:t.machineName,environment:t.environment,hostName:t.hostName,ip:t.ip};await l.updateDevice(Number(i),a),d("Sucess","Machine edited successfully","success"),m("/machines")}else{const a={machineName:t.machineName};await l.createDevice(a),d("Success","Machine created successfully","success"),m("/machines")}}catch(a){const x=a.response?.data?.message||"Falha ao salvar máquina";d("Error",x,"error")}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>m("/machines"),className:"text-primary hover:text-primary/80 mb-4",children:["← ",s("pages.machines.back")]}),e.jsx("h1",{className:"text-4xl font-semibold text-text-primary",children:s(n?"pages.machines.titleEdit":"pages.machines.titleCreate")})]}),e.jsxs("form",{onSubmit:h(p),className:"bg-white rounded-lg shadow-card p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("pages.machines.machineName")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("machineName",{required:s("pages.machines.machineNameRequired"),minLength:{value:5,message:s("pages.machines.machineNameMinLength")}}),placeholder:s("pages.machines.machineName"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"}),r.machineName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.machineName.message})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("pages.machines.environment")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("environment",{required:n?s("pages.machines.environmentRequired"):!1,minLength:{value:5,message:s("pages.machines.environmentMinLength")}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"}),r.environment&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.environment.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("pages.machines.hostname")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("hostName",{required:n?s("pages.machines.hostNameRequired"):!1,minLength:{value:3,message:s("pages.machines.hostNameMinLength")}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"}),r.hostName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.hostName.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s("pages.machines.ip")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("ip",{required:n?s("pages.machines.ipRequired"):!1,pattern:{value:/^(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)){3}$/,message:s("pages.machines.invalidIp")}}),placeholder:"192.168.1.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"}),r.ip&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.ip.message})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>m("/machines"),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:s("common.buttons.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90",children:s(n?"common.buttons.save":"common.buttons.create")})]})]})]})}export{S as default};
