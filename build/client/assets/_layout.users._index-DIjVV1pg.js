import{d as U,w as D}from"./vendor-router-cHSbYr8A.js";import{u as C,r as a,j as r}from"./vendor-react-GjWeapsa.js";import{u,c as d}from"./users.service-DV2TtZrl.js";import{u as b}from"./modal.service-0dNnnw9p.js";import{u as I}from"./notification.service-DGIhKrzX.js";import{D as R}from"./DynamicTable-2EKp7iLd.js";import"./api-Cdl3BoFR.js";function M(){const{t:s}=C("translation"),c=U(),p=b(e=>e.confirmDelete),f=b(e=>e.confirmEnable),o=I(e=>e.showToast),[g,h]=a.useState([]),[y,w]=a.useState(0),[n,x]=a.useState("SortField=id&SortOrder=asc&PageNumber=1&PageSize=100"),[m,S]=a.useState([]),E=a.useMemo(()=>[{key:"email",sortKey:"User.Email",label:s("pages.users.email"),filterable:!0,sortable:!0,filterType:"text"},{key:"role",label:s("pages.users.role"),filterable:!0,sortable:!1,filterType:"select",selectMode:"multiple",filterOptions:m},{key:"active",label:s("pages.automation.columnStatus"),filterable:!0,filterType:"select",selectMode:"single",sortable:!0,filterOptions:[{id:"true",label:s("common.status.active")},{id:"false",label:s("common.status.inactive")}]},{key:"actions",label:s("common.actions.label"),type:"action"}],[s,m]),j=a.useMemo(()=>[{label:s("common.buttons.edit"),action:"edit",icon:"edit"},{label:s("pages.users.disable"),action:"disable",icon:"block",showCondition:e=>e.activeValue},{label:s("pages.users.enable"),action:"enable",icon:"check_circle",showCondition:e=>!e.activeValue}],[s]),k=async()=>{try{const e=await d.getRoles();S(e.map(t=>({id:t.id,label:t.name})))}catch(e){console.error("Erro ao carregar roles:",e)}},l=async()=>{try{const e=await d.getAllUsers(n);w(e.totalItems),h(e.items.map(t=>({id:t.userId,email:t.userEmail,role:t.userRoles.map(i=>i).join(", ")||"",rolesId:t.userRoles?.map(i=>i).join(", ")||"",active:t.userActive?s("common.status.active"):s("common.status.inactive"),activeValue:t.userActive})))}catch(e){console.error("Erro ao carregar usuÃ¡rios:",e)}},N=async e=>{switch(e.action){case"edit":c(`/users/${e.item.id}`);break;case"disable":if(await p({description:"This action will permanently disable",itemName:e.item.email,buttonName:"Yes, Disabled"}))try{await u.disabledUser({id:Number(e.item.id),callerEmail:e.item.email}),o(s("common.states.success"),s("pages.users.disableSuccess"),"success"),l()}catch{o(s("common.states.error"),s("pages.users.disableError"),"error")}break;case"enable":if(await f({itemName:e.item.email}))try{await u.enabledUser({id:Number(e.item.id),callerEmail:e.item.email}),o(s("common.states.success"),s("pages.users.enableSuccess"),"success"),l()}catch{o(s("common.states.error"),s("pages.users.enableError"),"error")}break}},v=async()=>{await k(),await l()};return a.useEffect(()=>{v().then()},[n]),r.jsxs("div",{className:"min-h-screen bg-background",children:[r.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-8",children:[r.jsx("h1",{className:"text-3xl sm:text-4xl font-semibold text-text-primary",children:s("pages.users.title")}),r.jsx("button",{onClick:()=>c("/users/create"),className:"inline-flex items-center justify-center px-5 py-2.5 rounded-xl font-medium text-white bg-orange hover:bg-orange/90 shadow-sm hover:shadow transition-all duration-200",children:s("pages.users.createUser")})]}),r.jsx("section",{className:"mt-6",children:r.jsx(R,{columns:E,data:g,totalItems:y,pageSize:5,pageSizeOptions:[5,10,25,100],showFirstLastButtons:!0,actionMenuItems:j,onActionClick:N,onQueryParamsChange:x})})]})}const Q=D(function(){return r.jsx(M,{})});export{Q as default};
